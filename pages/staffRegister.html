<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Staff Registration</title>
</head>

<body>
    <%
   String isbn = request.getParameter("isbn");
   String title = request.getParameter("title");
   String bookyear = request.getParameter("bookyear");
   String purchaseprice = request.getParameter("purchaseprice");
   String saleprice = request.getParameter("saleprice");
   //out.println(title);
  
  
    String dbUser = "ISKANDAR";
    String dbPasswd = "iskandar";
    //String dbURL = "jdbc:oracle:thin:@sid3.comp.nus.edu.sg:1521:sid3";
    String dbURL = "jdbc:oracle:thin:@fsktmdbora.upm.edu.my:1521:FSKTM";
  
  Connection con=null;
  ResultSet rst=null;
  PreparedStatement pstatement=null;
  
     Class.forName("oracle.jdbc.driver.OracleDriver");
     int updateQuery = 0;
     
        // check if the text box is empty
   if(isbn!=null && title!=null && bookyear!=null && purchaseprice!=null && saleprice!=null){
        // check if the text box having only blank spaces
       if(isbn!="" && title!="" && bookyear!="" && purchaseprice!="" && saleprice!="") {
           try {
              
              con=DriverManager.getConnection(dbURL,dbUser,dbPasswd);
              String queryString = "INSERT INTO book(isbn, title,bookyear,purchaseprice, saleprice) VALUES (?, ?, ?, ?, ?)";
                      
              //pstatement = con.prepareStatement(queryString);
              pstatement = con.prepareStatement(queryString);
              pstatement.setString(1, isbn);
              pstatement.setString(2, title);
        pstatement.setString(3, bookyear);
        pstatement.setString(4, purchaseprice);
        pstatement.setString(5, saleprice);
        
              updateQuery = pstatement.executeUpdate();
                            if (updateQuery != 0) { %>
             <br>
             <TABLE style="background-color: #E3E4FA;" WIDTH="30%" border="1">
          <tr><th>Data is inserted successfully in database.</th></tr>
          
       </table>
       
       <br><a href="index.jsp">Home</a> <br>
       <br><a href="viewdatabase2.jsp">View All Books</a> <br>
      <br><a href="viewdatabase.jsp">View Books by Title</a> <br>
      <a href="insert.html">Insert New Records</a><br>
      <a href="update.jsp">Update Book Detail</a><br>
      <a href="delete.jsp">Update Book Detail</a><br>
      <a href="delete.jsp">Delete Book </a>
              <%
              }
            } 
            catch (Exception ex) {
            //out.println("Unable to connect to batabase.");
            %><TABLE style="background-color: #E3E4FA;" WIDTH="30%" border="1">
          <tr><th>data insert failed.</th></tr>
          
       </table>
       <br><a href="index.jsp">Home</a> <br>
       <br><a href="viewdatabase2.jsp">View All Books</a> <br>
      <br><a href="viewdatabase.jsp">View Books by Title</a> <br>
      <a href="insert.html">Insert New Records</a><br>
      <a href="update.jsp">Update Book Detail</a><br>
      <a href="delete.jsp">Update Book Detail</a><br>
      <a href="delete.jsp">Delete Book </a><%
               }
            finally {
                // close all the connections.
                pstatement.close();
                con.close();
            }
    }
  }
%>
    <style>
        * {

            font-family: sans-serif;
        }

        body {
            background-color: rgb(199, 204, 209);
        }

        button {

            background-color: #A3AFA7;
        }

        .note {
            margin-left: 20px;
            color: red;
            font-size: 13px;
        }
    </style>




    <table bgcolor=#f8e8ea style="margin:auto; width: 700px; height: 1000px; border: 5px solid #B3541E;" class="center">

        <tr>
            <th colspan="5"
                style="font-size: 30px ;background-color: #ffccd2;text-align:center; font-weight:bold ;border-bottom: 2px solid #ffccd2; color:#000000; ">
                STAFF REGISTRATION FORM
            </th>
        </tr>
        <tr>
        </tr>

        <form name="register" action="/action_page.php"  method="post" required onsubmit="return validateForm()">
            <tr>
                <td>
                    <p class="note">Fields marked with * are required.</p>
                </td>
            </tr>

            <tr>
                <td style="color:#000000; padding-left: 60px ;font-weight:bolder;">STAFF ID : *</td>
                <td><input type="text" id="staff_id" name="age" placeholder="Staff ID" /></td>
            </tr>

            <tr>
                <td style="color:#000000; padding-left: 60px ;font-weight:bolder;">FIRST NAME : *</td>
                <td><input style="width: 400px;" type="text" id="first_name" name="name" placeholder="First Name" /></td>
            </tr>

            <tr>
                <td style="color:#000000; padding-left: 60px ;font-weight:bolder;">LAST NAME : *</td>
                <td><input style="width: 400px;" type="text" id="last_name" name="name" placeholder="Last Name" /></td>
            </tr>

            <tr>
                <td></td>
                <td style="padding-bottom: 10px; padding-top:5px;">
                    <input type="RESET" value="RESET"
                        style="background-color:#ffccd2; color:#000000 ; border:#000000 0; width: 70px; height: 30px; border-style:solid; border-width: 3px;font-weight:bold;">
                    <button type="SUBMIT" onclick="validateForm()"
                        style="background-color:#ffccd2; color:#000000  ;border: #000000 0; width: 70px; height: 30px; border-style:solid; border-width: 3px;font-weight:bold;">
                        SUBMIT </button>
                    <button type=button onclick="window.location.href='registerPage.html'"
                        style=" background-color:#ffccd2; color:#000000 ;border: #000000 0; width: 70px; height: 30px;border-style:solid; border-width: 3px;font-weight:bold;">
                        BACK </button>
                </td>
            </tr>

    </table>




    </form>


    <script>
        function validateForm() {

            var name = document.forms['register']['name'].value;
            var age = document.forms['register']['age'].value;
            var letters = /^[A-Za-z]+$/;
            var numbers = /^[0-9]+$/;


            if (name == "" || name == null) {
                alert("Name must be filled out");
                return false;
            }
            if (age == "" || age == null) {
                alert("Age must be filled out");
                return false;
            }
            if (!letters.test(name)) {
                alert("Name must only have letters");
                return false;
            }
            if (!numbers.test(age)) {

                alert("Age must only have numbers");
                return false;
            }
            if (document.getElementById('gender_male').checked == false && document.getElementById('gender_female').checked == false) {

                alert("Please select a gender");
                return false;
            }
            if (document.getElementById('ward_silver').checked == false && document.getElementById('ward_gold').checked == false) {

                alert("Please select a ward");
                return false;
            }

            else
                alert("Submitted");

        }


        function checkOnlyOne(radio) {
            var gender = document.getElementsByName('gender')
            var ward = document.getElementsByName('ward')

            gender.forEach((item) => {
                if (item !== radio) item.checked = false
            })

            ward.forEach((item) => {
                if (item !== radio) item.checked = false
            })
        }

    </script>
</body>

</html>